<%-include("navbar")%>

<style>

:root {
      --primary-green: #2e7d32;
      --light-green: #4caf50;
      --lighter-green: #e8f5e9;
      --accent-orange: #ff9800;
      --dark-text: #2d3436;
    }
    
    .details_order_body {
      background: linear-gradient(135deg, #f9fbe7 0%, #e8f5e9 100%);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      color: var(--dark-text);
      min-height: 100vh;
    }
    
    .order_header {
      background: linear-gradient(to right, var(--primary-green), var(--light-green));
      color: white;
      padding: 15px 0;
      border-radius: 0 0 15px 15px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      margin-bottom: 30px;
    }
    
    .order-card_layout, .order_price-box {
      background: #fff;
      border-radius: 16px;
      padding: 25px;
      margin-bottom: 25px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.08);
      transition: transform 0.4s ease, box-shadow 0.4s ease;
      animation: fadeInUp 0.8s ease;
      border: 1px solid rgba(46, 125, 50, 0.1);
    }
    
    .order-card_layout:hover, .order_price-box:hover {
      transform: translateY(-8px);
      box-shadow: 0 12px 25px rgba(0,0,0,0.15);
    }

    /* Status icons */
    .order_status-icon{
      color: var(--primary-green);
      margin-right: 8px;
      animation: pulse 1.5s infinite alternate;
    }
    
    .order_status-timeline {
      position: relative;
      padding-left: 30px;
      margin: 20px 0;
    }
    
    .order_status-timeline::before {
      content: '';
      position: absolute;
      left: 10px;
      top: 5px;
      height: 90%;
      width: 3px;
      background: linear-gradient(to bottom, var(--primary-green), var(--light-green));
      border-radius: 3px;
    }
    
    .status-item {
      position: relative;
      margin-bottom: 20px;
      padding: 8px 15px;
      background: var(--lighter-green);
      border-radius: 10px;
      animation: slideInRight 0.6s ease;
      transition: all 0.3s ease;
    }
    
    .status-item:hover {
      transform: translateX(5px);
      box-shadow: 3px 3px 10px rgba(0,0,0,0.1);
    }
    
    .status-item::before {
      content: '';
      position: absolute;
      left: -25px;
      top: 50%;
      transform: translateY(-50%);
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: var(--primary-green);
      border: 3px solid white;
      box-shadow: 0 0 0 2px var(--primary-green);
    }

    /* Delivery Address Icons */
    .delivery-details p {
      margin-bottom: 8px;
      font-size: 15px;
    }
    
    .delivery-icon {
      background: var(--lighter-green);
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 15px;
      color: var(--primary-green);
      animation: bounceIn 1s ease;
    }

    /* Price box highlights */
    .order_price-box h6 {
      font-weight: bold;
      color: var(--primary-green);
      border-bottom: 2px dashed #e0e0e0;
      padding-bottom: 10px;
      margin-bottom: 15px;
    }
    
    .price-item {
      display: flex;
      justify-content: space-between;
      margin-bottom: 12px;
      padding: 5px 0;
      border-bottom: 1px solid #f5f5f5;
      animation: fadeIn 0.5s ease;
    }
    
    .price-item:hover {
      background: #f9f9f9;
      padding-left: 5px;
      border-radius: 5px;
    }
    
    .order_price-box .fw-bold {
      font-size: 20px;
      color: var(--primary-green);
    }
    
    .discount-badge {
      background: rgba(76, 175, 80, 0.15);
      color: var(--primary-green);
      padding: 5px 10px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      animation: pulse 2s infinite;
    }

    /* Rating stars */
    .rating-container {
      background: #fff9e6;
      border-radius: 12px;
      padding: 15px;
      margin-top: 20px;
      border: 1px dashed #ffd54f;
    }
    
    .rating-stars {
      font-size: 28px;
      color: #e0e0e0;
      cursor: pointer;
      transition: transform 0.2s ease, color 0.2s ease;
      margin: 0 2px;
      display: inline-block;
    }
    
    .rating-stars:hover {
      transform: scale(1.3) rotate(5deg);
    }
    
    .rating-stars.active {
      color: var(--accent-orange);
      transform: scale(1.4);
      filter: drop-shadow(0 0 3px rgba(255, 152, 0, 0.5));
    }
    
    .rating-label {
      font-weight: 600;
      color: var(--dark-text);
      margin-bottom: 10px;
      display: block;
    }

    /* Button style */
    .btn-primary {
      background: linear-gradient(to right, var(--primary-green), var(--light-green));
      border: none;
      border-radius: 30px;
      padding: 12px 25px;
      font-weight: 600;
      transition: all 0.3s ease;
      box-shadow: 0 4px 8px rgba(46, 125, 50, 0.3);
    }
    
    .btn-primary:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 6px 15px rgba(46, 125, 50, 0.4);
      background: linear-gradient(to right, var(--light-green), var(--primary-green));
    }
    
    .btn-outline {
      background: transparent;
      border: 2px solid var(--primary-green);
      color: var(--primary-green);
      border-radius: 30px;
      padding: 10px 20px;
      font-weight: 600;
      transition: all 0.3s ease;
    }
    
    .btn-outline:hover {
      background: var(--primary-green);
      color: white;
      transform: translateY(-3px);
      box-shadow: 0 5px 12px rgba(46, 125, 50, 0.3);
    }
    
    .product-img {
      width: 110px;
      height: 110px;
      object-fit: cover;
      border-radius: 12px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      transition: all 0.4s ease;
      animation: zoomIn 0.8s ease;
    }
    
    .product-img:hover {
      transform: scale(1.05) rotate(2deg);
      box-shadow: 0 8px 20px rgba(0,0,0,0.15);
    }
    
    .chat-link {
      display: inline-flex;
      align-items: center;
      padding: 10px 20px;
      background: #e3f2fd;
      border-radius: 25px;
      color: #1565c0;
      font-weight: 600;
      transition: all 0.3s ease;
    }
    
    .chat-link:hover {
      background: #bbdefb;
      transform: translateY(-3px);
      box-shadow: 0 5px 10px rgba(21, 101, 192, 0.2);
    }

    .status-item {
  opacity: 0.5; /* default inactive */
}
.status-item.active {
  opacity: 1;
  font-weight: bold;
  color: #007bff; /* highlight active */
}
.status-item.inactive {
  opacity: 0.4;
}

    /* Animations */
    @keyframes fadeInUp {
      from {opacity: 0; transform: translateY(30px);}
      to {opacity: 1; transform: translateY(0);}
    }
    
    @keyframes pulse {
      from {transform: scale(1); opacity: 0.8;}
      to {transform: scale(1.05); opacity: 1;}
    }
    
    @keyframes slideInRight {
      from {opacity: 0; transform: translateX(-20px);}
      to {opacity: 1; transform: translateX(0);}
    }
    
    @keyframes bounceIn {
      0% {transform: scale(0);}
      60% {transform: scale(1.2);}
      100% {transform: scale(1);}
    }
    
    @keyframes zoomIn {
      from {transform: scale(0.9); opacity: 0;}
      to {transform: scale(1); opacity: 1;}
    }
    
    @keyframes fadeIn {
      from {opacity: 0;}
      to {opacity: 1;}
    }
    
    .floating {
      animation: float 3s ease-in-out infinite;
    }
    
    @keyframes float {
      0% {transform: translateY(0px);}
      50% {transform: translateY(-8px);}
      100% {transform: translateY(0px);}
    }
    
    .progress-ring {
      position: relative;
      width: 60px;
      height: 60px;
      margin-right: 15px;
    }
    
    .progress-ring circle {
      transform: rotate(-90deg);
      transform-origin: 50% 50%;
      stroke-dasharray: 157;
      stroke-dashoffset: 157;
      animation: progress 1.5s ease-in-out forwards;
    }
    
    @keyframes progress {
      to {stroke-dashoffset: 31.4;} /* 80% progress */
    }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
      .order-card_layout, .order_price-box {
        padding: 20px;
      }
      
      .product-img {
        width: 90px;
        height: 90px;
      }
      
      .order_status-timeline::before {
        left: 8px;
      }
      
      .order_status-item::before {
        left: -20px;
      }
    }
</style>

<div class="container my-4">
  <div class="row">
    <!-- Left Side -->
    <div class="col-lg-8">
      <div class="order-card_layout">
        <div class="d-flex align-items-center">
          <div class="position-relative">
            <img src="/uploads/<%=order.main_image%>" 
                 alt="Organic Fertilizer" 
                 class="me-4 product-img floating">
            <span class="position-absolute top-0 start-0 translate-middle p-2 bg-success border border-light rounded-circle">
              <span class="visually-hidden">New alerts</span>
            </span>
          </div>
          <div>
            <h4 class="fw-bold text-dark mb-1"><%=order.product_name%> <%=order.weight%></h4>
            <p class="mb-2 text-muted">Seller: Krushi Seva Kendra</p>
            <div class="d-flex align-items-center">
              <h4 class="text-success fw-bold me-3">â‚¹<%=order.order_total%></h4>
              <!-- <span class="discount-badge text-white"><%=order.discount%> %</span> -->
            </div>
          </div>
        </div>

     <div class="order_status-timeline mt-4">

    <!-- Pending -->
    <div class="status-item <%= order.created_at ? 'active' : '' %>">
      <span><i class="bi bi-check-circle-fill order_status-icon"></i> Order Pending</span>
      <div class="text-muted small"><%= order.created_at ? order.created_at.toLocaleString() : '' %></div>
    </div>

    <!-- Shipped -->
    <div class="status-item <%= order.shipped_at ? 'active' : 'inactive' %>">
      <span><i class="bi bi-gear-fill status-icon"></i> Shipped</span>
      <div class="text-muted small"><%= order.shipped_at ? order.shipped_at.toLocaleString() : '' %></div>
    </div>

    

    <!-- Delivered -->
    <div class="status-item <%= order.delivered_at ? 'active' : 'inactive' %>">
      <span><i class="bi bi-box-seam status-icon"></i> Delivered</span>
      <div class="text-muted small"><%= order.completed_at ? order.completed_at.toLocaleString() : '' %></div>
    </div>

    <!-- Cancelled -->
    <div class="status-item <%= order.cancelled_at ? 'active text-danger' : 'inactive' %>">
      <span><i class="bi bi-x-circle-fill"></i> Cancelled</span>
      <div class="text-muted small"><%= order.cancelled_at ? order.cancelled_at.toLocaleString() : '' %></div>
    </div>
</div>

      

        <div class="mb-3">
          <a href="#" class="chat-link text-decoration-none">
            <i class="bi bi-chat-dots-fill me-2"></i> Chat with our support team
          </a>
        </div>

        <!-- Rating -->
        <!-- <div class="rating-container">
          <span class="rating-label">Rate this product:</span>
          <div>
            <span class="rating-stars" data-value="1"><i class="bi bi-star-fill"></i></span>
            <span class="rating-stars" data-value="2"><i class="bi bi-star-fill"></i></span>
            <span class="rating-stars" data-value="3"><i class="bi bi-star-fill"></i></span>
            <span class="rating-stars" data-value="4"><i class="bi bi-star-fill"></i></span>
            <span class="rating-stars" data-value="5"><i class="bi bi-star-fill"></i></span>
          </div>
          <div class="mt-2 text-muted small">Click on a star to rate</div>
        </div> -->
      </div>
    </div>

    <!-- Right Side -->
    <div class="col-lg-4">
      <!-- Delivery Details -->
      <div class="order_price-box delivery-details mb-4">
        <h6><i class="bi bi-geo-alt-fill me-2"></i> Delivery details</h6>
        <div class="d-flex mt-3">
          <div class="delivery-icon">
            <i class="bi bi-house-door"></i>
          </div>
          <div>
            <p class="mb-1 fw-semibold">Home Address</p>
            <p class="text-muted mb-0"><%=order.village%>, <%=order.taluka%>, <%=order.district%>, <%=order.state%></p>
          </div>
        </div>
        
        <div class="d-flex mt-3">
          <div class="delivery-icon">
            <i class="bi bi-person"></i>
          </div>
          <div>
            <p class="mb-1 fw-semibold"><%=order.name%></p>
            <p class="text-muted mb-0">ðŸ“ž<%=order.mobile%></p>
          </div>
        </div>
      </div>

      <!-- Price Details -->
      <div class="order_price-box">
        <h6><i class="bi bi-receipt me-2"></i> Price details</h6>
        
        <div class="price-item">
          <span>Listing price</span>
          <span class="text-decoration-line-through">â‚¹<%=order.originalPrice%></span>
        </div>
        
        <div class="price-item">
          <span>Selling price</span>
          <span>â‚¹<%=order.price%></span>
        </div>
        
        <div class="price-item">
          <span>Save Amount</span>
          <span class="text-success">-â‚¹<%=order.saved%></span>
        </div>
        
        <hr>
        
        <div class="price-item">
          <span class="fw-bold">Total amount</span>
          <span class="fw-bold text-success">â‚¹<%=order.price%></span>
        </div>
        
        <div class="mt-3">
          <span class="badge bg-light text-dark border p-2 w-100 d-flex align-items-center">
            <i class="bi bi-wallet2 me-2"></i> <%=order.payment_method%>
          </span>
        </div>
        
        <a href="/download_invoice/<%=order.order_id%>"  class="btn btn-primary w-100 mt-4 py-2">
          <i class="bi bi-download me-2"></i> Download Invoice
        </a>
        
        <a href="/product" class="btn btn-outline w-100 mt-3">
          <i class="bi bi-arrow-repeat me-2"></i> Order Again
        </a>
      </div>
    </div>
  </div>
</div>

<script>
  // Rating stars JS
  const stars = document.querySelectorAll('.rating-stars');
  let currentRating = 0;
  
  stars.forEach((star, index) => {
    star.addEventListener('click', () => {
      currentRating = index + 1;
      stars.forEach((s, i) => {
        if (i <= index) {
          s.classList.add('active');
        } else {
          s.classList.remove('active');
        }
      });
      
      // Show thank you message after rating
      const ratingContainer = document.querySelector('.rating-container');
      if (!document.querySelector('.thank-you-message')) {
        const thankYou = document.createElement('div');
        thankYou.className = 'thank-you-message mt-3 text-center text-success fw-semibold';
        thankYou.innerHTML = <i class="bi bi-check-circle-fill me-1"></i> Thanks for your ${currentRating} star rating!;
        thankYou.style.animation = 'fadeIn 0.5s ease';
        ratingContainer.appendChild(thankYou);
        
        // Remove message after 3 seconds
        setTimeout(() => {
          thankYou.remove();
        }, 3000);
      }
    });
    
    // Add hover effect
    star.addEventListener('mouseover', () => {
      stars.forEach((s, i) => {
        if (i <= index) {
          s.style.color = '#ffb74d';
        }
      });
    });
    
    star.addEventListener('mouseout', () => {
      if (currentRating === 0) {
        stars.forEach(s => s.style.color = '#e0e0e0');
      } else {
        stars.forEach((s, i) => {
          if (i >= currentRating) {
            s.style.color = '#e0e0e0';
          }
        });
      }
    });
  });
  
  // Add animation to price items on page load
  document.addEventListener('DOMContentLoaded', () => {
    const priceItems = document.querySelectorAll('.price-item');
    priceItems.forEach((item, index) => {
      item.style.animationDelay = ${index * 0.1}s;
    });
    
    // Animate status items with delay
    const statusItems = document.querySelectorAll('.status-item');
    statusItems.forEach((item, index) => {
      item.style.animationDelay = ${index * 0.2}s;
    });
  });
</script>

<%-include("footer")%>
