<%- include("navbar.ejs") %>

    <!-- Main Content -->
    <div class="container">
        <!-- Sidebar Filters -->
        <aside class="sidebar">
            <div class="sidebar-section">
                <h3>Categories</h3>
                <div class="filter-option">
                    <label>
                        <input type="checkbox" checked>
                        Seeds
                    </label>
                </div>
                <div class="filter-option">
                    <label>
                        <input type="checkbox">
                        Fertilizers
                    </label>
                </div>
                <div class="filter-option">
                    <label>
                        <input type="checkbox">
                        Crop Protection
                    </label>
                </div>
                <div class="filter-option">
                    <label>
                        <input type="checkbox">
                        Farming Tools
                    </label>
                </div>
                <div class="filter-option">
                    <label>
                        <input type="checkbox">
                        Irrigation
                    </label>
                </div>
            </div>

            <div class="sidebar-section">
                <h3>Brands</h3>
                <div class="filter-option">
                    <label>
                        <input type="checkbox">
                        Syngenta
                    </label>
                </div>
                <div class="filter-option">
                    <label>
                        <input type="checkbox" checked>
                        FMC
                    </label>
                </div>
                <div class="filter-option">
                    <label>
                        <input type="checkbox">
                        Bayer
                    </label>
                </div>
                <div class="filter-option">
                    <label>
                        <input type="checkbox">
                        UPL
                    </label>
                </div>
                <div class="filter-option">
                    <label>
                        <input type="checkbox">
                        Mahyco
                    </label>
                </div>
            </div>

            <div class="sidebar-section">
                <h3>Price Range</h3>
                <input type="range" min="0" max="5000" value="2500" class="price-slider">
                <div class="price-range">
                    <span>₹0</span>
                    <span>₹5000</span>
                </div>
            </div>

            <div class="sidebar-section">
                <h3>Customer Rating</h3>
                <div class="rating-filter">
                    <i class="fas fa-star rating-star active"></i>
                    <i class="fas fa-star rating-star active"></i>
                    <i class="fas fa-star rating-star active"></i>
                    <i class="fas fa-star rating-star active"></i>
                    <i class="fas fa-star rating-star"></i>
                    <span>&amp; Up</span>
                </div>
            </div>
        </aside>

        <!-- Main Content Area -->
        <main class="main-content">
            <div class="toolbar">
                <div class="results-count">Showing 12 of 48 products</div>
                <div class="sorting">
                    <label for="sort">Sort By:</label>
                    <select id="sort">
                        <option value="best">Best Selling</option>
                        <option value="price_asc">Price: Low to High</option>
                        <option value="price_desc">Price: High to Low</option>
                        <option value="discount">Discount</option>
                        <option value="rating">Customer Rating</option>
                    </select>
                </div>
            </div>

            <!-- Product Grid -->
            <div class="products-grid">
                <!-- Product Card 1 -->
                <div class="product-card">
                    <div class="discount-badge">25% OFF</div>
                    <div class="wishlist-icon">
                        <i class="far fa-heart"></i>
                    </div>
                    <div class="image-container">
                        <img src="https://tse2.mm.bing.net/th/id/OIP.4XsW9jpGHXCHYiOdAJnYvAHaHa?r=0&rs=1&pid=ImgDetMain&o=7&rm=3" alt="Seed Packet" class="product-image">
                    </div>
                    <div class="product-info">
                        <h3 class="product-title">Premium Hybrid Tomato Seeds</h3>
                        <div class="product-brand">Syngenta</div>
                        <div class="pricing">
                            <div class="current-price">₹349</div>
                            <div class="old-price">₹465</div>
                            <div class="savings">Save ₹116</div>
                        </div>
                        <div class="size-selector">
                            <select>
                                <option>50g Pack</option>
                                <option>100g Pack</option>
                                <option>250g Pack</option>
                            </select>
                        </div>
                        <button class="add-to-cart-btn">
                            <i class="fas fa-shopping-cart"></i> Add to Cart
                        </button>
                        <div class="rating">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star-half-alt"></i>
                            <span>(42)</span>
                        </div>
                    </div>
                </div>

                <!-- Product Card 2 -->
                <div class="product-card">
                    <div class="discount-badge">30% OFF</div>
                    <div class="wishlist-icon">
                        <i class="far fa-heart"></i>
                    </div>
                    <div class="image-container">
                        <img src="https://m.media-amazon.com/images/I/415wgk6yCxL.SY445_SX342_QL70_ML2.jpg" alt="NPK Fertilizer" class="product-image">
                    </div>
                    <div class="product-info">
                        <h3 class="product-title">NPK 20:20:20 Water Soluble Fertilizer</h3>
                        <div class="product-brand">Bayer</div>
                        <div class="pricing">
                            <div class="current-price">₹899</div>
                            <div class="old-price">₹1285</div>
                            <div class="savings">Save ₹386</div>
                        </div>
                        <div class="size-selector">
                            <select>
                                <option>1kg Bag</option>
                                <option>5kg Bag</option>
                                <option>10kg Bag</option>
                            </select>
                        </div>
                        <button class="add-to-cart-btn">
                            <i class="fas fa-shopping-cart"></i> Add to Cart
                        </button>
                        <div class="rating">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <span>(28)</span>
                        </div>
                    </div>
                </div>

                <!-- Product Card 3 -->
                <div class="product-card">
                    <div class="discount-badge">15% OFF</div>
                    <div class="wishlist-icon">
                        <i class="far fa-heart"></i>
                    </div>
                    <div class="image-container">
                        <img src="https://tse4.mm.bing.net/th/id/OIP.48cITyUl-JvYdDHlg0ZhqgHaHa?r=0&rs=1&pid=ImgDetMain&o=7&rm=3" alt="Insecticide" class="product-image">
                    </div>
                    <div class="product-info">
                        <h3 class="product-title">Coragen Insecticide - Chlorantraniliprole</h3>
                        <div class="product-brand">FMC</div>
                        <div class="pricing">
                            <div class="current-price">₹650</div>
                            <div class="old-price">₹765</div>
                            <div class="savings">Save ₹115</div>
                        </div>
                        <div class="size-selector">
                            <select>
                                <option>50ml Bottle</option>
                                <option>100ml Bottle</option>
                                <option>250ml Bottle</option>
                            </select>
                        </div>
                        <button class="add-to-cart-btn">
                            <i class="fas fa-shopping-cart"></i> Add to Cart
                        </button>
                        <div class="rating">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="far fa-star"></i>
                            <span>(36)</span>
                        </div>
                    </div>
                </div>

                <!-- Product Card 4 -->
                <div class="product-card">
                    <div class="discount-badge">40% OFF</div>
                    <div class="wishlist-icon">
                        <i class="far fa-heart"></i>
                    </div>
                    <div class="image-container">
                        <img src="https://tse2.mm.bing.net/th/id/OIP.pT676bL66UOBAHSz8tnaUgHaKQ?r=0&w=1000&h=1384&rs=1&pid=ImgDetMain&o=7&rm=3" alt="Wheat Seeds" class="product-image">
                    </div>
                    <div class="product-info">
                        <h3 class="product-title">High Yield Wheat Seeds - HD 2967</h3>
                        <div class="product-brand">Mahyco</div>
                        <div class="pricing">
                            <div class="current-price">₹1299</div>
                            <div class="old-price">₹2165</div>
                            <div class="savings">Save ₹866</div>
                        </div>
                        <div class="size-selector">
                            <select>
                                <option>1kg Pack</option>
                                <option>5kg Pack</option>
                                <option>10kg Pack</option>
                            </select>
                        </div>
                        <button class="add-to-cart-btn">
                            <i class="fas fa-shopping-cart"></i> Add to Cart
                        </button>
                        <div class="rating">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star-half-alt"></i>
                            <i class="far fa-star"></i>
                            <span>(19)</span>
                        </div>
                    </div>
                </div>

                <!-- Product Card 5 -->
                <div class="product-card">
                    <div class="discount-badge">10% OFF</div>
                    <div class="wishlist-icon">
                        <i class="far fa-heart"></i>
                    </div>
                    <div class="image-container">
                        <img src="https://th.bing.com/th/id/OIP.RgbBTsJFuSPPSUMjtBgLvgHaHa?r=0&o=7rm=3&rs=1&pid=ImgDetMain&o=7&rm=3" alt="Sprayer" class="product-image">
                    </div>
                    <div class="product-info">
                        <h3 class="product-title">Manual Crop Sprayer - 5 Liters</h3>
                        <div class="product-brand">UPL</div>
                        <div class="pricing">
                            <div class="current-price">₹1250</div>
                            <div class="old-price">₹1390</div>
                            <div class="savings">Save ₹140</div>
                        </div>
                        <div class="size-selector">
                            <select>
                                <option>5L</option>
                                <option>10L</option>
                                <option>15L</option>
                            </select>
                        </div>
                        <button class="add-to-cart-btn">
                            <i class="fas fa-shopping-cart"></i> Add to Cart
                        </button>
                        <div class="rating">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star-half-alt"></i>
                            <span>(47)</span>
                        </div>
                    </div>
                </div>

                <!-- Product Card 6 -->
                <div class="product-card">
                    <div class="discount-badge">20% OFF</div>
                    <div class="wishlist-icon">
                        <i class="far fa-heart"></i>
                    </div>
                    <div class="image-container">
                        <img src="https://images-na.ssl-images-amazon.com/images/I/71iPA5LfB7L.SL1500.jpg" alt="Organic Manure" class="product-image">
                    </div>
                    <div class="product-info">
                        <h3 class="product-title">Vermicompost Organic Manure</h3>
                        <div class="product-brand">Organic Farms</div>
                        <div class="pricing">
                            <div class="current-price">₹299</div>
                            <div class="old-price">₹375</div>
                            <div class="savings">Save ₹76</div>
                        </div>
                        <div class="size-selector">
                            <select>
                                <option>5kg Bag</option>
                                <option>10kg Bag</option>
                                <option>25kg Bag</option>
                            </select>
                        </div>
                        <button class="add-to-cart-btn">
                            <i class="fas fa-shopping-cart"></i> Add to Cart
                        </button>
                        <div class="rating">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="far fa-star"></i>
                            <span>(31)</span>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Farming Animation -->
    <div class="farm-animation">
        <div class="sun"></div>
        <div class="tree tree-1">
            <div class="tree-trunk"></div>
            <div class="tree-top"></div>
        </div>
        <div class="tree tree-2">
            <div class="tree-trunk"></div>
            <div class="tree-top"></div>
        </div>
        <div class="tree tree-3">
            <div class="tree-trunk"></div>
            <div class="tree-top"></div>
        </div>
        <div class="tree tree-4">
            <div class="tree-trunk"></div>
            <div class="tree-top"></div>
        </div>
        <div class="tree tree-5">
            <div class="tree-trunk"></div>
            <div class="tree-top"></div>
        </div>
        <div class="plant plant-1">
            <div class="plant-stem"></div>
            <div class="plant-leaf leaf-1"></div>
            <div class="plant-leaf leaf-2"></div>
        </div>
        <div class="plant plant-2">
            <div class="plant-stem"></div>
            <div class="plant-leaf leaf-1"></div>
            <div class="plant-leaf leaf-2"></div>
        </div>
        <div class="plant plant-3">
            <div class="plant-stem"></div>
            <div class="plant-leaf leaf-1"></div>
            <div class="plant-leaf leaf-2"></div>
        </div>
        <div class="plant plant-4">
            <div class="plant-stem"></div>
            <div class="plant-leaf leaf-1"></div>
            <div class="plant-leaf leaf-2"></div>
        </div>
    </div>

    <script>
        // GSAP Animations
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize GSAP with ScrollTrigger
            gsap.registerPlugin(ScrollTrigger);
            
            // Create a timeline for the intro animation
            const introTimeline = gsap.timeline({
                onComplete: () => {
                    // After the intro, add the CSS transition for the hover effect.
                    // This prevents a conflict between the GSAP intro and CSS hover.
                    gsap.utils.toArray('.product-card').forEach(card => {
                        card.style.transition = 'transform 0.3s ease, box-shadow 0.3s ease';
                    });
                }
            });
            
            // Add the card animation to the timeline
            introTimeline.from('.product-card', {
                opacity: 0,
                y: 30,
                duration: 0.8,
                stagger: 0.1,
                ease: "back.out(1.7)",
                delay: 0.3
            });
            
            // Discount badge animation
            gsap.to('.discount-badge', {
                y: -3,
                duration: 0.8,
                yoyo: true,
                repeat: -1,
                ease: "sine.inOut"
            });
            
            // Sun animation
            gsap.to('.sun', {
                rotation: 360,
                duration: 30,
                repeat: -1,
                ease: "none"
            });
            
            // A more realistic and smooth plant growth animation
            gsap.utils.toArray('.plant').forEach((plant, i) => {
                gsap.set(plant, { transformOrigin: "50% 100%" }); // Ensure growth is from the bottom
                
                const tl = gsap.timeline({
                    repeat: -1,
                    yoyo: true,
                    delay: i * 0.4 // Stagger the start of each plant's animation
                });

                tl.to(plant, {
                    scaleY: 1.15, // Grow slightly taller
                    skewX: (i % 2 === 0) ? 4 : -4, // Sway gently to one side
                    duration: 3 + Math.random() * 1.5, // Randomize duration for a natural look
                    ease: "sine.inOut"
                });
            });
            
            // Add parallax effect to product images
            gsap.utils.toArray('.product-card').forEach(card => {
                const image = card.querySelector('.product-image');
                gsap.fromTo(image, 
                    { yPercent: -10 }, // Start slightly up
                    {
                        yPercent: 10,  // End slightly down
                        ease: "none",
                        scrollTrigger: {
                            trigger: card,
                            scrub: true
                        }
                    }
                );
            });
            
            // --- Event Delegation for all card interactions ---
            document.body.addEventListener('click', function(e) {
                
                // Add to Cart Button Logic
                const addToCartBtn = e.target.closest('.add-to-cart-btn');
                if (addToCartBtn && !addToCartBtn.classList.contains('added')) {
                    const originalText = addToCartBtn.innerHTML;
                    const cartCountEl = document.querySelector('.cart-count');
                    
                    addToCartBtn.classList.add('added');
                    addToCartBtn.innerHTML = '<i class="fas fa-check"></i> Added ✓';
                    
                    gsap.to(addToCartBtn, { scale: 0.95, duration: 0.1, yoyo: true, repeat: 1 });

                    // Animate and update cart count
                    gsap.to('.cart-count', {
                        scale: 1.5,
                        duration: 0.2,
                        yoyo: true,
                        repeat: 1,
                        onComplete: () => {
                            cartCountEl.textContent = parseInt(cartCountEl.textContent) + 1;
                        }
                    });

                    // Reset button after 1.5 seconds
                    setTimeout(() => {
                        addToCartBtn.classList.remove('added');
                        addToCartBtn.innerHTML = originalText;
                    }, 1500);
                }

                // Wishlist Icon Logic
                const wishlistIcon = e.target.closest('.wishlist-icon');
                if (wishlistIcon) {
                    const heartIcon = wishlistIcon.querySelector('i');
                    const isWishlisted = heartIcon.classList.contains('fas');

                    if (!isWishlisted) {
                        heartIcon.classList.replace('far', 'fas');
                        wishlistIcon.classList.add('active');
                        
                        gsap.to(wishlistIcon, {
                            scale: 1.3,
                            duration: 0.3,
                            yoyo: true,
                            repeat: 1,
                            ease: "elastic.out(1, 0.5)"
                        });
                    } else {
                        heartIcon.classList.replace('fas', 'far');
                        wishlistIcon.classList.remove('active');
                        
                        gsap.to(wishlistIcon, {
                            scale: 0.8,
                            duration: 0.2,
                            yoyo: true,
                            repeat: 1
                        });
                    }
                }
            });

        });
    </script>
