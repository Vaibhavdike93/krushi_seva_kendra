<%- include("navbar.ejs") %>
<style>
  /* Unique class names for soil testing page */
  .soil-test-page * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
  }

  .soil-test-page {
    --navbar-bg: #FAFAF5;
    --page-bg: #FAF8F0;
    --button-color: #F4A300;
    --button-hover-color: #8B5E3C;
    --footer-bg: #8B5E3C;
    --text-primary: #2D2D2D;
    --text-secondary: #5C5C5C;
    --green-accent: #4CAF50;
    --light-green: #E8F5E9;
    --border-radius: 12px;
    --box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    --box-shadow-hover: 0 8px 20px rgba(0, 0, 0, 0.12);
    --card-bg: #F8F4E6;
    --accent-orange: #FF9933;
    --accent-yellow: #FFC72C;
    --neutral-light: #FAFAF5;
    --text-dark: #2D2D2D;
    --text-light: #5C5C5C;
    --transition: all 0.4s ease;
    
    background-color: var(--page-bg);
    color: var(--text-dark);
    line-height: 1.6;
  }

  .soil-test-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
  }

  /* Header Styles */
  .soil-test-header {
    text-align: center;
    padding: 60px 20px;
    background: linear-gradient(135deg, var(--accent-yellow) 0%, var(--accent-orange) 100%);
    border-radius: var(--border-radius);
    margin-bottom: 40px;
    box-shadow: var(--box-shadow);
    position: relative;
    overflow: hidden;
  }

  .soil-test-header::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1440 320'%3E%3Cpath fill='%23ffffff' fill-opacity='0.1' d='M0,160L48,176C96,192,192,224,288,218.7C384,213,480,171,576,165.3C672,160,768,192,864,192C960,192,1056,160,1152,144C1248,128,1344,128,1392,128L1440,128L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z'%3E%3C/path%3E%3C/svg%3E");
    background-size: cover;
    background-position: bottom;
  }

  .soil-test-header h1 {
    font-size: 2.8rem;
    margin-bottom: 15px;
    color: var(--text-dark);
    position: relative;
  }

  .soil-test-header p {
    font-size: 1.2rem;
    max-width: 700px;
    margin: 0 auto 30px;
    color: var(--text-dark);
    position: relative;
  }

  .soil-test-stats-container {
    display: flex;
    justify-content: center;
    gap: 30px;
    margin-top: 40px;
    flex-wrap: wrap;
    position: relative;
  }

  .soil-test-stat-item {
    background: rgba(255, 255, 255, 0.8);
    padding: 20px;
    border-radius: 10px;
    min-width: 180px;
    text-align: center;
    box-shadow: var(--box-shadow);
  }

  .soil-test-stat-number {
    font-size: 2.5rem;
    font-weight: 700;
    color: var(--accent-orange);
    margin-bottom: 5px;
  }

  .soil-test-stat-label {
    font-size: 1rem;
    color: var(--text-light);
  }

  /* Info Section */
  .soil-test-info-section {
    background-color: var(--neutral-light);
    padding: 30px;
    border-radius: var(--border-radius);
    margin-bottom: 40px;
    box-shadow: var(--box-shadow);
  }

  .soil-test-info-section p {
    margin-bottom: 25px;
    font-size: 1.1rem;
  }

  .soil-test-benefits-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-top: 30px;
  }

  .soil-test-benefit-card {
    background-color: var(--accent-yellow);
    padding: 25px;
    border-radius: var(--border-radius);
    text-align: center;
    transition: var(--transition);
    position: relative;
    overflow: hidden;
  }

  .soil-test-benefit-card::after {
    content: "";
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 5px;
    background: var(--accent-orange);
    transform: scaleX(0);
    transform-origin: left;
    transition: transform 0.3s ease;
  }

  .soil-test-benefit-card:hover {
    transform: translateY(-5px);
    background-color: var(--accent-yellow);
    box-shadow: var(--box-shadow-hover);
  }

  .soil-test-benefit-card:hover::after {
    transform: scaleX(1);
  }

  .soil-test-benefit-icon {
    font-size: 2.5rem;
    margin-bottom: 15px;
    color: var(--text-dark);
  }

  /* Form Styles */
  .soil-test-form-section {
    background-color: var(--neutral-light);
    padding: 30px;
    border-radius: var(--border-radius);
    margin-bottom: 40px;
    box-shadow: var(--box-shadow);
  }

  .soil-test-form-title {
    text-align: center;
    margin-bottom: 30px;
    color: var(--text-dark);
    font-size: 1.8rem;
  }

  .soil-test-form {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
  }

  .soil-test-form-group {
    margin-bottom: 20px;
    position: relative;
  }

  .soil-test-form-group label {
    display: block;
    margin-bottom: 8px;
    font-weight: 600;
    color: var(--text-dark);
  }

  .soil-test-form-control {
    width: 100%;
    padding: 12px 15px;
    border: 2px solid #ddd;
    border-radius: var(--border-radius);
    font-size: 1rem;
    transition: var(--transition);
  }

  .soil-test-form-control:focus {
    border-color: var(--accent-orange);
    outline: none;
    box-shadow: 0 0 0 3px rgba(255, 153, 51, 0.2);
  }

  .soil-test-form-error {
    color: #f44336;
    font-size: 0.85rem;
    margin-top: 5px;
    display: none;
  }

  .soil-test-btn-submit {
    background-color: var(--button-color);
    color: var(--text-dark);
    border: none;
    padding: 15px 25px;
    font-size: 1.1rem;
    font-weight: 600;
    border-radius: var(--border-radius);
    cursor: pointer;
    transition: var(--transition);
    grid-column: 1 / -1;
    justify-self: center;
    width: 200px;
    margin-top: 10px;
    position: relative;
    overflow: hidden;
  }

  .soil-test-btn-submit::after {
    content: "";
    position: absolute;
    top: 50%;
    left: 50%;
    width: 5px;
    height: 5px;
    background: rgba(255, 255, 255, 0.5);
    opacity: 0;
    border-radius: 100%;
    transform: scale(1, 1) translate(-50%);
    transform-origin: 50% 50%;
  }

  .soil-test-btn-submit:hover {
    background-color: var(--button-hover-color);
    color: white;
    animation: soil-test-pulse 1.5s infinite;
  }

  .soil-test-btn-submit:active::after {
    animation: soil-test-ripple 1s ease-out;
  }

  @keyframes soil-test-ripple {
    0% {
      transform: scale(0, 0);
      opacity: 0.5;
    }
    20% {
      transform: scale(20, 20);
      opacity: 0.3;
    }
    100% {
      transform: scale(50, 50);
      opacity: 0;
    }
  }

  @keyframes soil-test-pulse {
    0% {
      box-shadow: 0 0 0 0 rgba(244, 163, 0, 0.7);
    }
    70% {
      box-shadow: 0 0 0 10px rgba(244, 163, 0, 0);
    }
    100% {
      box-shadow: 0 0 0 0 rgba(244, 163, 0, 0);
    }
  }

  .soil-test-file-upload-wrapper {
    position: relative;
    margin-bottom: 20px;
  }

  .soil-test-file-upload-label {
    display: block;
    padding: 12px 15px;
    border: 2px dashed #ddd;
    border-radius: var(--border-radius);
    text-align: center;
    cursor: pointer;
    transition: var(--transition);
  }

  .soil-test-file-upload-label:hover {
    border-color: var(--accent-orange);
    background-color: rgba(255, 153, 51, 0.1);
  }

  .soil-test-file-name {
    margin-top: 8px;
    font-size: 0.9rem;
    color: var(--text-light);
  }

  /* Loading Spinner */
  .soil-test-spinner {
    display: none;
    width: 40px;
    height: 40px;
    margin: 20px auto;
    border: 4px solid rgba(255, 153, 51, 0.3);
    border-radius: 50%;
    border-top: 4px solid var(--accent-orange);
    animation: soil-test-spin 1s linear infinite;
  }

  @keyframes soil-test-spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }

  /* Sample Report Section */
  .soil-test-sample-report {
    background-color: var(--neutral-light);
    padding: 30px;
    border-radius: var(--border-radius);
    margin-bottom: 40px;
    box-shadow: var(--box-shadow);
  }

  .soil-test-sample-report h2 {
    text-align: center;
    margin-bottom: 30px;
    color: var(--text-dark);
  }

  .soil-test-report-preview {
    border: 1px solid #ddd;
    border-radius: var(--border-radius);
    padding: 20px;
    background: #f9f9f9;
    margin-bottom: 20px;
  }

  .soil-test-report-image {
    width: 100%;
    border-radius: var(--border-radius);
    display: block;
    margin: 0 auto;
    max-width: 400px;
  }

  .soil-test-btn-view-sample {
    background-color: var(--green-accent);
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: var(--border-radius);
    cursor: pointer;
    display: block;
    margin: 0 auto;
    transition: background 0.3s;
  }

  .soil-test-btn-view-sample:hover {
    background-color: #3d8b40;
  }

  /* FAQ Section */
  .soil-test-faq-section {
    background-color: var(--neutral-light);
    padding: 30px;
    border-radius: var(--border-radius);
    margin-bottom: 40px;
    box-shadow: var(--box-shadow);
  }

  .soil-test-faq-title {
    text-align: center;
    margin-bottom: 30px;
    color: var(--text-dark);
  }

  .soil-test-faq-item {
    margin-bottom: 20px;
    border-bottom: 1px solid #eee;
    padding-bottom: 20px;
  }

  .soil-test-faq-question {
    font-weight: 600;
    margin-bottom: 10px;
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .soil-test-faq-answer {
    color: var(--text-light);
    display: none;
    padding-top: 10px;
  }

  .soil-test-faq-active .soil-test-faq-answer {
    display: block;
  }

  /* Testimonials Section */
  .soil-test-testimonials {
    background-color: var(--neutral-light);
    padding: 30px;
    border-radius: var(--border-radius);
    margin-bottom: 40px;
    box-shadow: var(--box-shadow);
  }

  .soil-test-testimonials h2 {
    text-align: center;
    margin-bottom: 30px;
    color: var(--text-dark);
  }

  .soil-test-testimonial-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
  }

  .soil-test-testimonial-card {
    background: var(--card-bg);
    padding: 20px;
    border-radius: var(--border-radius);
    position: relative;
  }

  .soil-test-testimonial-card::before {
    content: "";
    font-size: 4rem;
    color: var(--accent-yellow);
    position: absolute;
    top: -10px;
    left: 10px;
    line-height: 1;
  }

  .soil-test-testimonial-text {
    margin-bottom: 15px;
    font-style: italic;
  }

  .soil-test-testimonial-author {
    font-weight: 600;
    color: var(--accent-orange);
  }

  /* Modal */
  .soil-test-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
    z-index: 1000;
    justify-content: center;
    align-items: center;
  }

  .soil-test-modal-content {
    background-color: var(--neutral-light);
    padding: 30px;
    border-radius: var(--border-radius);
    max-width: 600px;
    width: 90%;
    max-height: 80vh;
    overflow-y: auto;
    position: relative;
  }

  .soil-test-close-modal {
    position: absolute;
    top: 15px;
    right: 15px;
    font-size: 1.5rem;
    cursor: pointer;
    color: var(--text-light);
  }

  /* Responsive Design */
  @media (max-width: 900px) {
  }

  @media (max-width: 768px) {
    .soil-test-form {
      grid-template-columns: 1fr;
    }

    .soil-test-header h1 {
      font-size: 2.2rem;
    }

    .soil-test-benefits-grid {
      grid-template-columns: 1fr;
    }

    .soil-test-stats-container {
      gap: 15px;
    }

    .soil-test-stat-item {
      min-width: 140px;
      padding: 15px;
    }

    .soil-test-stat-number {
      font-size: 2rem;
    }
  }

  @media (max-width: 600px) {
    .soil-test-stats-container {
      flex-direction: column;
      align-items: center;
    }

    .soil-test-stat-item {
      width: 100%;
      max-width: 250px;
    }
  }

  @media (max-width: 480px) {
    .soil-test-header h1 {
      font-size: 1.8rem;
    }

    .soil-test-form-control {
      padding: 10px 12px;
    }

    .soil-test-btn-submit {
      width: 100%;
    }

    .soil-test-header {
      padding: 40px 20px;
    }
  }
</style>

<div class="soil-test-page">
  <div class="soil-test-container">
    <header class="soil-test-header">
      <h1>üß™ Soil Testing & Analysis</h1>
      <p>
        Check your soil's health and get crop-specific fertilizer guidance to maximize your yield.
      </p>
      
      <div class="soil-test-stats-container">
        <div class="soil-test-stat-item">
          <div class="soil-test-stat-number">15,000+</div>
          <div class="soil-test-stat-label">Tests Conducted</div>
        </div>
        <div class="soil-test-stat-item">
          <div class="soil-test-stat-number">92%</div>
          <div class="soil-test-stat-label">Satisfied Farmers</div>
        </div>
        <div class="soil-test-stat-item">
          <div class="soil-test-stat-number">30-70%</div>
          <div class="soil-test-stat-label">Yield Increase</div>
        </div>
      </div>
    </header>

    <div class="soil-test-info-section">
      <p>
        Soil testing helps farmers understand soil fertility, choose the right
        crops, and apply the right fertilizers. This saves cost and increases
        yield by providing precise recommendations based on scientific analysis.
      </p>

      <div class="soil-test-benefits-grid">
        <div class="soil-test-benefit-card">
          <div class="soil-test-benefit-icon">üå±</div>
          <h3>Better Crop Yield</h3>
          <p>Increase your harvest with optimized soil conditions</p>
        </div>

        <div class="soil-test-benefit-card">
          <div class="soil-test-benefit-icon">üí∞</div>
          <h3>Cost Savings</h3>
          <p>Reduce fertilizer expenses by applying only what's needed</p>
        </div>

        <div class="soil-test-benefit-card">
          <div class="soil-test-benefit-icon">üß™</div>
          <h3>Accurate Reports</h3>
          <p>Get detailed analysis of your soil's health</p>
        </div>
        
        <div class="soil-test-benefit-card">
          <div class="soil-test-benefit-icon">üåç</div>
          <h3>Eco-Friendly</h3>
          <p>Reduce environmental impact with precise fertilizer use</p>
        </div>
      </div>
    </div>

    <!-- Sample Report Section -->
    <div class="soil-test-sample-report">
      <h2>View Sample Soil Report</h2>
      <div class="soil-test-report-preview">
        <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='250' viewBox='0 0 400 250'%3E%3Crect width='400' height='250' fill='%23f0f0f0'/%3E%3Ctext x='200' y='125' font-family='Arial' font-size='20' text-anchor='middle' fill='%23333'%3ESample Soil Analysis Report%3C/text%3E%3C/svg%3E" 
             alt="Sample Soil Report" class="soil-test-report-image">
      </div>
      <button class="soil-test-btn-view-sample" id="soilTestViewSampleBtn">View Sample Report</button>
    </div>

    <div class="soil-test-form-section">
      <h2 class="soil-test-form-title">Submit Soil Sample for Analysis</h2>

      <form class="soil-test-form" id="soilTestForm">
        <div class="soil-test-form-group">
          <label for="soilTestFarmerName">Farmer's Name</label>
          <input
            type="text"
            id="soilTestFarmerName"
            class="soil-test-form-control"
            placeholder="Enter your full name"
            required
          />
          <div class="soil-test-form-error" id="soilTestNameError">Please enter a valid name</div>
        </div>

        <div class="soil-test-form-group">
          <label for="soilTestContactNumber">Contact Number</label>
          <input
            type="tel"
            id="soilTestContactNumber"
            class="soil-test-form-control"
            placeholder="Enter your phone number"
            required
          />
          <div class="soil-test-form-error" id="soilTestPhoneError">Please enter a valid phone number</div>
        </div>

        <div class="soil-test-form-group">
          <label for="soilTestLocation">Location / Village</label>
          <input
            type="text"
            id="soilTestLocation"
            class="soil-test-form-control"
            placeholder="Enter your village name"
            required
          />
          <div class="soil-test-form-error" id="soilTestLocationError">Please enter your location</div>
        </div>

        <div class="soil-test-form-group">
          <label for="soilTestSoilType">Type of Soil</label>
          <select id="soilTestSoilType" class="soil-test-form-control" required>
            <option value="">Select Soil Type</option>
            <option value="black">Black Soil</option>
            <option value="red">Red Soil</option>
            <option value="alluvial">Alluvial Soil</option>
            <option value="sandy">Sandy Soil</option>
            <option value="loamy">Loamy Soil</option>
          </select>
          <div class="soil-test-form-error" id="soilTestSoilTypeError">Please select soil type</div>
        </div>

        <div class="soil-test-form-group">
          <label for="soilTestCropPlanned">Crop Planned</label>
          <select id="soilTestCropPlanned" class="soil-test-form-control" required>
            <option value="">Select Crop</option>
            <option value="soybean">Soybean</option>
            <option value="cotton">Cotton</option>
            <option value="wheat">Wheat</option>
            <option value="sugarcane">Sugarcane</option>
            <option value="vegetables">Vegetables</option>
            <option value="pulses">Pulses</option>
          </select>
          <div class="soil-test-form-error" id="soilTestCropError">Please select a crop</div>
        </div>

        <div class="soil-test-spinner" id="soilTestFormSpinner"></div>

        <button type="submit" class="soil-test-btn-submit">Book Appointment</button>
      </form>
    </div>

    <!-- Testimonials Section -->
    <div class="soil-test-testimonials">
      <h2>What Farmers Say</h2>
      <div class="soil-test-testimonial-grid">
        <div class="soil-test-testimonial-card">
          <p class="soil-test-testimonial-text">The soil testing service helped me reduce my fertilizer cost by 30% while increasing my soybean yield.</p>
          <p class="soil-test-testimonial-author">- Rajesh Kumar, Nanded</p>
        </div>
        <div class="soil-test-testimonial-card">
          <p class="soil-test-testimonial-text">I followed the recommendations and got the best cotton yield in my area. Thank you Krushi Seva Kendra!</p>
          <p class="soil-test-testimonial-author">- Sunita Patil, Yavatmal</p>
        </div>
        <div class="soil-test-testimonial-card">
          <p class="soil-test-testimonial-text">The detailed report helped me understand my soil better. Now I know exactly what nutrients to add.</p>
          <p class="soil-test-testimonial-author">- Vijay Jawale, Amravati</p>
        </div>
      </div>
    </div>

    <!-- FAQ Section -->
    <div class="soil-test-faq-section">
      <h2 class="soil-test-faq-title">Frequently Asked Questions</h2>
      
      <div class="soil-test-faq-item">
        <div class="soil-test-faq-question">
          How long does it take to get soil test results?
          <i class="fas fa-chevron-down"></i>
        </div>
        <div class="soil-test-faq-answer">
          Typically, it takes 3-5 business days to receive your soil test results after we receive your sample. During peak season, it may take up to 7 days.
        </div>
      </div>
      
      <div class="soil-test-faq-item">
        <div class="soil-test-faq-question">
          How do I collect a proper soil sample?
          <i class="fas fa-chevron-down"></i>
        </div>
        <div class="soil-test-faq-answer">
          Collect soil from 10-15 random spots across your field at a depth of 6-8 inches. Mix these samples together and let it dry. Send about 500g of this mixed soil for testing.
        </div>
      </div>
      
      <div class="soil-test-faq-item">
        <div class="soil-test-faq-question">
          What parameters are tested in the soil?
          <i class="fas fa-chevron-down"></i>
        </div>
        <div class="soil-test-faq-answer">
          Our basic test includes pH level, NPK (Nitrogen, Phosphorus, Potassium), organic carbon, and soil texture. Advanced tests include micronutrients and other properties.
        </div>
      </div>
      
      <div class="soil-test-faq-item">
        <div class="soil-test-faq-question">
          How often should I test my soil?
          <i class="fas fa-chevron-down"></i>
        </div>
        <div class="soil-test-faq-answer">
          We recommend testing your soil at least once every 2-3 years. However, if you're changing crops or notice yield decline, test before each cropping season.
        </div>
      </div>
    </div>
  </div>

  <!-- Modal for sample report -->
  <div class="soil-test-modal" id="soilTestSampleModal">
    <div class="soil-test-modal-content">
      <span class="soil-test-close-modal" id="soilTestCloseModal">&times;</span>
      <h2>Sample Soil Test Report</h2>
      <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='500' height='350' viewBox='0 0 500 350'%3E%3Crect width='500' height='350' fill='%23f9f9f9'/%3E%3Ctext x='250' y='30' font-family='Arial' font-size='20' text-anchor='middle' fill='%23333'%3ESOIL TEST REPORT%3C/text%3E%3Cline x1='50' y1='50' x2='450' y2='50' stroke='%23333' stroke-width='2'/%3E%3Ctext x='50' y='80' font-family='Arial' font-size='16' fill='%23333'%3EFarmer: Sample Farmer%3C/text%3E%3Ctext x='50' y='110' font-family='Arial' font-size='16' fill='%23333'%3ELocation: Sample Village%3C/text%3E%3Ctext x='50' y='140' font-family='Arial' font-size='16' fill='%23333'%3ESoil Type: Black Soil%3C/text%3E%3Ctext x='50' y='170' font-family='Arial' font-size='16' fill='%23333'%3EpH: 7.2%3C/text%3E%3Ctext x='50' y='200' font-family='Arial' font-size='16' fill='%23333'%3ENitrogen: Medium%3C/text%3E%3Ctext x='50' y='230' font-family='Arial' font-size='16' fill='%23333'%3EPhosphorus: Low%3C/text%3E%3Ctext x='50' y='260' font-family='Arial' font-size='16' fill='%23333'%3EPotassium: High%3C/text%3E%3Ctext x='50' y='290' font-family='Arial' font-size='16' fill='%23333'%3ERecommended Crops: Soybean, Cotton%3C/text%3E%3Ctext x='50' y='320' font-family='Arial' font-size='16' fill='%23333'%3EFertilizer: 50kg Urea + 25kg DAP/acre%3C/text%3E%3C/svg%3E" 
           alt="Detailed Sample Report" style="width: 100%; margin-top: 20px;">
    </div>
  </div>
</div>

<script>
  // Initialize GSAP animations
  gsap.registerPlugin(ScrollTrigger);

  // Animate header elements
  gsap.from(".soil-test-header h1", {
    duration: 1,
    y: -50,
    opacity: 0,
    ease: "power2.out",
  });

  gsap.from(".soil-test-header p", {
    duration: 1,
    y: -30,
    opacity: 0,
    delay: 0.3,
    ease: "power2.out",
  });

  // Animate stats
  gsap.utils.toArray(".soil-test-stat-item").forEach((item, i) => {
    gsap.from(item, {
      scrollTrigger: {
        trigger: ".soil-test-stats-container",
        start: "top 85%",
        toggleActions: "play none none none",
      },
      opacity: 0,
      y: 30,
      duration: 0.8,
      delay: i * 0.2,
      ease: "power2.out",
    });
  });

  // Animate info section
  gsap.from(".soil-test-info-section p", {
    scrollTrigger: {
      trigger: ".soil-test-info-section",
      start: "top 85%",
      toggleActions: "play none none none",
    },
    x: -100,
    opacity: 0,
    duration: 1,
    ease: "power2.out",
  });

  // Animate benefit cards with bounce effect
  gsap.utils.toArray(".soil-test-benefit-card").forEach((card, i) => {
    gsap.from(card, {
      scrollTrigger: {
        trigger: card,
        start: "top 90%",
        toggleActions: "play none none none",
      },
      opacity: 0,
      y: 50,
      duration: 0.8,
      delay: i * 0.2,
      ease: "bounce.out",
    });

    // Animate icons with spin effect
    gsap.from(card.querySelector(".soil-test-benefit-icon"), {
      scrollTrigger: {
        trigger: card,
        start: "top 90%",
        toggleActions: "play none none none",
      },
      rotation: -180,
      opacity: 0,
      duration: 1,
      delay: i * 0.2 + 0.3,
    });
  });

  // Animate form elements
  gsap.utils.toArray(".soil-test-form-group").forEach((field, i) => {
    gsap.from(field, {
      scrollTrigger: {
        trigger: ".soil-test-form-section",
        start: "top 85%",
        toggleActions: "play none none none",
      },
      x: -50,
      opacity: 0,
      duration: 0.6,
      delay: i * 0.1,
    });
  });

  // Animate submit button
  gsap.from(".soil-test-btn-submit", {
    scrollTrigger: {
      trigger: ".soil-test-btn-submit",
      start: "top 90%",
      toggleActions: "play none none none",
    },
    scale: 0,
    rotation: -180,
    duration: 0.8,
    ease: "elastic.out(1, 0.5)",
  });

  // Form validation
  const soilTestForm = document.getElementById('soilTestForm');
  const soilTestNameError = document.getElementById('soilTestNameError');
  const soilTestPhoneError = document.getElementById('soilTestPhoneError');
  const soilTestLocationError = document.getElementById('soilTestLocationError');
  const soilTestSoilTypeError = document.getElementById('soilTestSoilTypeError');
  const soilTestCropError = document.getElementById('soilTestCropError');
  const soilTestSpinner = document.getElementById('soilTestFormSpinner');

  if (soilTestForm) {
    soilTestForm.addEventListener('submit', function(e) {
      e.preventDefault();
      
      // Basic validation
      let isValid = true;
      const farmerName = document.getElementById('soilTestFarmerName').value;
      const contactNumber = document.getElementById('soilTestContactNumber').value;
      const location = document.getElementById('soilTestLocation').value;
      const soilType = document.getElementById('soilTestSoilType').value;
      const cropPlanned = document.getElementById('soilTestCropPlanned').value;
      
      // Name validation
      if (!farmerName || farmerName.length < 3) {
        soilTestNameError.style.display = 'block';
        isValid = false;
      } else {
        soilTestNameError.style.display = 'none';
      }
      
      // Phone validation (simple Indian mobile number validation)
      const phoneRegex = /^[6-9]\d{9}$/;
      if (!contactNumber || !phoneRegex.test(contactNumber)) {
        soilTestPhoneError.style.display = 'block';
        isValid = false;
      } else {
        soilTestPhoneError.style.display = 'none';
      }
      
      // Location validation
      if (!location) {
        soilTestLocationError.style.display = 'block';
        isValid = false;
      } else {
        soilTestLocationError.style.display = 'none';
      }
      
      // Soil type validation
      if (!soilType) {
        soilTestSoilTypeError.style.display = 'block';
        isValid = false;
      } else {
        soilTestSoilTypeError.style.display = 'none';
      }
      
      // Crop validation
      if (!cropPlanned) {
        soilTestCropError.style.display = 'block';
        isValid = false;
      } else {
        soilTestCropError.style.display = 'none';
      }
      
      if (!isValid) {
        // Shake form to indicate errors
        gsap.to(soilTestForm, {
          x: 10,
          duration: 0.1,
          repeat: 5,
          yoyo: true,
          onComplete: () => {
            gsap.to(soilTestForm, { x: 0, duration: 0.1 });
          }
        });
        return;
      }
      
      // Show loading spinner
      soilTestSpinner.style.display = 'block';
      
      // Simulate processing delay
      setTimeout(() => {
        soilTestSpinner.style.display = 'none';
        alert('Form submitted successfully! We will get back to you shortly.');
        soilTestForm.reset();
      }, 2000);
    });
  }

  // Add hover effects to form elements
  const soilTestFormControls = document.querySelectorAll(".soil-test-form-control");
  soilTestFormControls.forEach((control) => {
    control.addEventListener("focus", () => {
      control.style.backgroundColor = "#FFF8E1";
    });

    control.addEventListener("blur", () => {
      control.style.backgroundColor = "#fff";
    });
  });

  // Sample report modal functionality
  const soilTestViewSampleBtn = document.getElementById('soilTestViewSampleBtn');
  const soilTestSampleModal = document.getElementById('soilTestSampleModal');
  const soilTestCloseModal = document.getElementById('soilTestCloseModal');

  if (soilTestViewSampleBtn) {
    soilTestViewSampleBtn.addEventListener('click', () => {
      soilTestSampleModal.style.display = 'flex';
      document.body.style.overflow = 'hidden';
    });
  }

  if (soilTestCloseModal) {
    soilTestCloseModal.addEventListener('click', () => {
      soilTestSampleModal.style.display = 'none';
      document.body.style.overflow = 'auto';
    });
  }

  // Close modal when clicking outside
  window.addEventListener('click', (e) => {
    if (e.target === soilTestSampleModal) {
      soilTestSampleModal.style.display = 'none';
      document.body.style.overflow = 'auto';
    }
  });

  // FAQ functionality
  const soilTestFaqQuestions = document.querySelectorAll('.soil-test-faq-question');
  
  soilTestFaqQuestions.forEach(question => {
    question.addEventListener('click', () => {
      const faqItem = question.parentElement;
      faqItem.classList.toggle('soil-test-faq-active');
      
      const icon = question.querySelector('i');
      if (faqItem.classList.contains('soil-test-faq-active')) {
        icon.classList.remove('fa-chevron-down');
        icon.classList.add('fa-chevron-up');
      } else {
        icon.classList.remove('fa-chevron-up');
        icon.classList.add('fa-chevron-down');
      }
    });
  });

  // Animate testimonials
  gsap.utils.toArray('.soil-test-testimonial-card').forEach((card, i) => {
    gsap.from(card, {
      scrollTrigger: {
        trigger: '.soil-test-testimonials',
        start: 'top 85%',
        toggleActions: 'play none none none'
      },
      opacity: 0,
      y: 30,
      duration: 0.8,
      delay: i * 0.2,
      ease: 'power2.out'
    });
  });

  // Animate FAQ items
  gsap.utils.toArray('.soil-test-faq-item').forEach((item, i) => {
    gsap.from(item, {
      scrollTrigger: {
        trigger: '.soil-test-faq-section',
        start: 'top 85%',
        toggleActions: 'play none none none'
      },
      opacity: 0,
      x: -30,
      duration: 0.6,
      delay: i * 0.1,
      ease: 'power2.out'
    });
  });
</script>

<%-include("footer.ejs")%>